<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="common.css">
  </head>
  <body>
    <div id="container"></div>
    <script src="../lib/require.js"></script>
    <script src="../requirejs.conf.js"></script>
    <script>
      require(['glimpse'], function (glimpse) {
        'use strict';

        var sampleData = [
          { "ts": 1317279600000, "sys": 30, "user": 20, "stolen": 1, "wait": 9, "idle": 40},
          { "ts": 1317695968421, "sys": 31, "user": 19, "stolen": 1, "wait": 9, "idle": 40},
          { "ts": 1318112336842, "sys": 30, "user": 21, "stolen": 0, "wait": 9, "idle": 40},
          { "ts": 1318528705263, "sys": 30, "user": 21, "stolen": 0, "wait": 9, "idle": 40},
          { "ts": 1318945073684, "sys": 40, "user": 21, "stolen": 0, "wait": 9, "idle": 30},
          { "ts": 1319361442105, "sys": 30, "user": 21, "stolen": 0, "wait": 9, "idle": 40},
          { "ts": 1319777810526, "sys": 30, "user": 21, "stolen": 0, "wait": 9, "idle": 40},
          { "ts": 1320194178947, "sys": 30, "user": 21, "stolen": 0, "wait": 9, "idle": 40},
          { "ts": 1320610547368, "sys": 30, "user": 20, "stolen": 1, "wait": 9, "idle": 40},
          { "ts": 1321026915789, "sys": 10, "user": 10, "stolen": 1, "wait": 9, "idle": 70},
          { "ts": 1321443284210, "sys": 30, "user": 20, "stolen": 1, "wait": 9, "idle": 40},
          { "ts": 1321859652631, "sys": 30, "user": 20, "stolen": 1, "wait": 9, "idle": 40},
          { "ts": 1322276021052, "sys": 30, "user": 20, "stolen": 1, "wait": 9, "idle": 40}
        ];

        var xAccessor = function (d) { return d.ts; };
        var areaGraph = glimpse.graph()
          .data([
            { id: 'cpu-sys',
              title: 'System',
              data: sampleData,
              x: xAccessor,
              y: function (d, i) { return d.user; }
            },
            { id: 'cpu-user',
              title: 'User',
              data: sampleData,
              x: xAccessor,
              y: function (d, i) { return d.sys; }
            },
            { id: 'cpu-idle',
              title: 'Idle',
              data: sampleData,
              x: xAccessor,
              y: function (d, i) { return d.idle; }
            },
            { id: 'cpu-wait',
              title: 'Wait',
              data: sampleData,
              x: xAccessor,
              y: function (d, i) { return d.wait; }
            },
            { id: 'cpu-stolen',
              title: 'Stolen',
              data: sampleData,
              x: xAccessor,
              y: function (d, i) { return d.stolen; }
            }
          ])
          // TODO: allow component() to take an array
          .component({ type: 'area', dataId: 'cpu-idle', color: '#EFEFEF' })
          .component({ type: 'area', dataId: 'cpu-user', color: '#89D6FF' })
          .component({ type: 'area', dataId: 'cpu-sys', color: '#FFB578' })
          .component({ type: 'area', dataId: 'cpu-wait', color: '#F5F692' })
          .component({ type: 'area', dataId: 'cpu-stolen', color: '#FF5A86' })
          .render('#container');


          // for debugging
          window.graph = areaGraph;
          window.gl = glimpse;
        });
    </script>
  </body>
</html>
